{"version":3,"sources":["../../../../assets/scripts/assets/scripts/gameMgr.js"],"names":["cc","Class","extends","Component","properties","dataCenter","default","visible","fishesNode","Node","catchFishNode","gotFishesNode","dollorLabel","Label","catchFishNodeOriginPosition","moveDuration","catchedFishAnimTime","addDollorLabelAnimTime","addDollorLabelAnimMoveUpDistance","onLoad","require","getPosition","openTouchEvent","startRefreshFishes","updateDollorLabelStr","start","update","dt","fishesOnScreen","children","helper","index","oneFishOnScreen","isOneNodeInAnotherNode","fishMgr","getComponent","fishData","fishPosition","playerData","currentDollor","playerDataSys","updatePlayerData","removeFromParent","self","loader","loadRes","fishModelName","err","catchedFishPrefab","catchedFish","instantiate","position","catchedFishTargetPosition","v2","jumpAction","jumpTo","scalUpAction","scaleTo","scalDownAction","scalAction","sequence","removeSelf","catchedFishAction","spawn","turnOneNodeToOnePosition","addChild","runAction","addDollorLabelPrefab","addDollorLabelNode","addDollorLabel","string","toString","fadeAction","fadeOut","labelAction","upAction","moveBy","finalAction","onDestroy","closeTouchEvent","node","on","touchBegan","touchMoved","touchEnd","touchCancel","off","event","x","getLocationX","y","getLocationY","location","convertToNodeSpaceAR","setPosition","motionComponent","MotionStreak","enabled","motion","element","neededFishesData","tempFunc","para","setInterval","refreshOneFishByFishData","timeDelta","probability","isHittedByProbability","fishPrefab","newFish","spawnAreaNum","Math","random","floor","targetAreaNum","getTargetAreaNumBySpawnAreaNum","spawnPosition","getOneRandomPositionBySpawnArea","targetPosition","swimLeft","rotateBy","leftBack","swimRight","rightBack","swimAction","swimAnimation","repeatForever","moveAction","moveTo","fishAction","givenNum","target","givenNode","spawnX","spawnY","width","height","strForLabel","formatNumberShowStyle"],"mappings":"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","file":"gameMgr.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        dataCenter: {\n            default: null,\n            visible: false\n        },\n\n        fishesNode: cc.Node,\n        catchFishNode: cc.Node,\n        gotFishesNode: cc.Node,\n        dollorLabel: cc.Label,\n\n        catchFishNodeOriginPosition: {\n            default: null,\n            visible: false\n        },\n        moveDuration: 5,\n        catchedFishAnimTime:0.5,\n        addDollorLabelAnimTime: 0.5,\n        addDollorLabelAnimMoveUpDistance: 50\n        \n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.dataCenter = require(\"dataCenter\");\n        this.catchFishNodeOriginPosition = this.catchFishNode.getPosition();\n        this.openTouchEvent();\n        this.startRefreshFishes();\n        this.updateDollorLabelStr();\n    },\n\n    start () {\n\n    },\n\n    update (dt) {\n        //check whether the catchfish node is in one fish node\n        var fishesOnScreen = this.fishesNode.children;\n        var helper = require(\"helper\");\n        for (var index in fishesOnScreen) {\n            var oneFishOnScreen = fishesOnScreen[index];\n            if (helper.isOneNodeInAnotherNode(this.catchFishNode,oneFishOnScreen) == true) {\n                var fishMgr = oneFishOnScreen.getComponent(\"fishMgr\");\n                var fishData = fishMgr.fishData;\n                var fishPosition = oneFishOnScreen.getPosition();\n\n                //add dollor\n                this.dataCenter.playerData.currentDollor += fishData.currentDollor;\n                this.updateDollorLabelStr();\n\n                var playerDataSys = require(\"playerDataSys\");\n                playerDataSys.updatePlayerData();\n                //remove the fish\n                oneFishOnScreen.removeFromParent();\n                //one new fish for animation of catched fish\n                var self = this;\n                cc.loader.loadRes(fishData.fishModelName,function(err,catchedFishPrefab){\n                    if(err){\n                        return\n                    }\n                    var catchedFish = cc.instantiate(catchedFishPrefab); \n                    catchedFish.position = fishPosition;\n                    \n                    var catchedFishTargetPosition = cc.v2(0,-151);\n                    var jumpAction = cc.jumpTo(self.catchedFishAnimTime,catchedFishTargetPosition,50,1);\n                    var scalUpAction = cc.scaleTo(0.3 * self.catchedFishAnimTime,1.5,1.5);\n                    var scalDownAction = cc.scaleTo(0.7 * self.catchedFishAnimTime,0.5,0.5);\n                    var scalAction = cc.sequence(scalUpAction,scalDownAction,cc.removeSelf());\n                    var catchedFishAction = cc.spawn(jumpAction,scalAction);\n                    \n\n                    helper.turnOneNodeToOnePosition(catchedFish,catchedFishTargetPosition);\n                    self.gotFishesNode.addChild(catchedFish);\n                    catchedFish.runAction(catchedFishAction);\n\n                    cc.loader.loadRes(\"addDollorLabel\",function(err,addDollorLabelPrefab){\n                        var addDollorLabelNode = cc.instantiate(addDollorLabelPrefab);\n                        var addDollorLabel = addDollorLabelNode.getComponent(cc.Label);\n                        addDollorLabel.string = \"+ $ \" + fishData.currentDollor.toString();\n                        addDollorLabelNode.position = catchedFish.position;\n                        self.gotFishesNode.addChild(addDollorLabelNode);\n\n                        var fadeAction = cc.fadeOut(self.addDollorLabelAnimTime);\n                        var labelAction = cc.sequence(fadeAction,cc.removeSelf());\n                        var upAction = cc.moveBy(self.addDollorLabelAnimTime,cc.v2(0,self.addDollorLabelAnimMoveUpDistance));\n                        var finalAction = cc.spawn(labelAction,upAction)\n                        addDollorLabelNode.runAction(finalAction);\n                    });\n                    \n                })\n            }\n        }\n    },\n    onDestroy(){\n        this.closeTouchEvent();\n    },\n\n    openTouchEvent() {\n        this.node.on(\"touchstart\",this.touchBegan,this);\n        this.node.on(\"touchmove\",this.touchMoved,this);\n        this.node.on(\"touchend\",this.touchEnd,this);\n        this.node.on(\"touchcancel\",this.touchCancel,this);\n    },\n    closeTouchEvent(){\n        this.node.off(\"touchstart\",this.touchBegan,this);\n        this.node.off(\"touchmove\",this.touchMoved,this);\n        this.node.off(\"touchend\",this.touchEnd,this);\n        this.node.off(\"touchcancel\",this.touchCancel,this); \n    },  \n    touchBegan(event){\n        var x = event.getLocationX();\n        var y = event.getLocationY();\n        var location = this.node.convertToNodeSpaceAR(cc.v2(x,y));\n\n        this.catchFishNode.setPosition(location.x,location.y);\n        var motionComponent = this.catchFishNode.getComponent(cc.MotionStreak);\n        motionComponent.enabled = true;\n\n    },\n    touchMoved(event){\n        var x = event.getLocationX();\n        var y = event.getLocationY();\n        var location = this.node.convertToNodeSpaceAR(cc.v2(x,y));\n        this.catchFishNode.setPosition(location.x,location.y);\n    },\n    touchEnd(event){\n        var motion = this.catchFishNode.getComponent(cc.MotionStreak);\n        motion.enabled = false;\n        this.catchFishNode.setPosition(this.catchFishNodeOriginPosition);\n\n    },\n    touchCancel(event){\n        this.touchEnd();\n    }, \n\n    startRefreshFishes(){\n\n        var self = this;\n        for(var element in this.dataCenter.neededFishesData) {\n            var fishData = this.dataCenter.neededFishesData[element];\n\n            var tempFunc = function(para){\n                setInterval(function(){\n                    self.refreshOneFishByFishData(para);\n                },(para.timeDelta * 1000 ));\n            };\n            tempFunc(fishData);    \n        }\n    },\n\n    refreshOneFishByFishData(fishData) {\n        var probability = fishData.probability;\n        var helper = require(\"helper\");\n        if(helper.isHittedByProbability(probability,10000) == false) {\n            return\n        }\n        var self = this;\n        cc.loader.loadRes(fishData.fishModelName,function(err,fishPrefab){\n            var newFish = cc.instantiate(fishPrefab);\n            var spawnAreaNum = Math.random() * 4;\n            spawnAreaNum = Math.floor(spawnAreaNum);\n            var targetAreaNum = self.getTargetAreaNumBySpawnAreaNum(spawnAreaNum);\n\n            var spawnPosition = self.getOneRandomPositionBySpawnArea(spawnAreaNum,newFish,self.node);\n            newFish.setPosition(spawnPosition);\n            self.fishesNode.addChild(newFish);\n            var fishMgr = newFish.getComponent(\"fishMgr\");\n            fishMgr.fishData = fishData;\n\n            var targetPosition = self.getOneRandomPositionBySpawnArea(targetAreaNum,newFish,self.node);\n            helper.turnOneNodeToOnePosition(newFish,targetPosition);\n\n            var swimLeft = cc.rotateBy(0.5,30);\n            var leftBack = cc.rotateBy(0.5, -30);\n            var swimRight = cc.rotateBy(0.5, -30);\n            var rightBack = cc.rotateBy(0.5, 30);\n            var swimAction = cc.sequence(swimLeft, leftBack, swimRight, rightBack);\n            var swimAnimation = cc.repeatForever(swimAction);\n            newFish.runAction(swimAnimation);\n\n            var moveAction = cc.moveTo(self.moveDuration,targetPosition);\n            var fishAction = cc.sequence(moveAction,cc.removeSelf());\n            newFish.runAction(fishAction);\n        });\n    },\n    getTargetAreaNumBySpawnAreaNum(givenNum) {\n        var target = null;\n        switch(givenNum) {\n            case 0:\n                target = 1;\n                break;\n            case 1:\n                target = 0;\n                break;\n            case 2:\n                target = 3;\n                break;\n            case 3:\n                target = 2;\n                break;\n        }\n        return target;\n    },\n    getOneRandomPositionBySpawnArea(spawnAreaNum,newFish,givenNode){\n        var spawnX = null;\n        var spawnY = null;\n\n        if(spawnAreaNum == 0) {\n             spawnX = -1 * givenNode.width/2 - newFish.width/2;\n             spawnY = Math.random() * givenNode.height - givenNode.height/2;\n        }\n        else if(spawnAreaNum == 1){\n            spawnX = givenNode.width/2 + newFish.width/2;\n            spawnY = Math.random() * givenNode.height - givenNode.height/2;\n        }\n        else if(spawnAreaNum == 2) {\n            spawnY = givenNode.height/2 + newFish.height/2;\n            spawnX = Math.random() * givenNode.width - givenNode.width/2;\n        }\n        else if(spawnAreaNum == 3) {\n            spawnY = -givenNode.height/2 - newFish.height/2;\n            spawnX = Math.random() * givenNode.width - givenNode.width/2;\n        }\n        return cc.v2(spawnX,spawnY);\n    },\n    updateDollorLabelStr(){\n        var helper = require(\"helper\");\n        var currentDollor = this.dataCenter.playerData.currentDollor;\n        var strForLabel = helper.formatNumberShowStyle(currentDollor);\n        strForLabel = \"$ \" + strForLabel;\n        this.dollorLabel.string = strForLabel;\n    }\n});\n"]}